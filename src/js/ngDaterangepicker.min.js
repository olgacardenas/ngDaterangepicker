angular.module("jkuri.daterangepicker",[]).directive("ngDaterangepicker",["$document",function(a){return{restrict:"EA",require:"?ngModel",scope:true,link:function(i,e,g,d){i.format=g.format||"YYYY-MM-DD";i.locale=g.locale||"en";i.opened=false;i.dayNames=[];i.viewValue=null;i.dateFromValue=null;i.dateToValue=null;i.daterange="";i.selectedDateFrom=null;i.selectedDateTo=null;moment.locale(i.locale);var f=moment();var h=moment();var c=function(m,s){var t=f.endOf("month").date(),q=f.month(),l=f.year(),o=1,n;var k=h.endOf("month").date(),w=h.month(),r=h.year(),v=1;var u=i.firstWeekDaySunday===true?f.set("date",2).day():f.set("date",1).day();if(u!==1){o-=u-1}var p=i.firstWeekDaySunday===true?h.set("date",2).day():h.set("date",1).day();if(p!==1){v-=p-1}if(s!==undefined){i.daysTo=[];i.dateToValue=h.format("MMMM YYYY");for(n=v;n<=k;n+=1){if(n>0){i.daysTo.push({day:n,month:w+1,year:r,enabled:true})}else{i.daysTo.push({day:null,month:null,year:null,enabled:false})}}}else{i.daysFrom=[];i.dateFromValue=f.format("MMMM YYYY");for(n=o;n<=t;n+=1){if(n>0){i.daysFrom.push({day:n,month:q+1,year:l,enabled:true})}else{i.daysFrom.push({day:null,month:null,year:null,enabled:false})}}}};var j=function(){var k=i.firstWeekDaySunday===true?moment("2015-06-07"):moment("2015-06-01");for(var l=0;l<7;l+=1){i.dayNames.push(k.format("ddd"));k.add("1","d")}};j();c(f);c(h,true);i.open=function(){i.opened=true};i.close=function(){i.opened=false};i.prevYear=function(k){if(k!==undefined){h.subtract(1,"Y");c(h,true)}else{f.subtract(1,"Y");c(f)}};i.prevMonth=function(k){if(k!==undefined){h.subtract(1,"M");c(h,true)}else{f.subtract(1,"M");c(f)}};i.nextMonth=function(k){if(k!==undefined){h.add(1,"M");c(h,true)}else{f.add(1,"M");c(f)}};i.nextYear=function(k){if(k!==undefined){h.add(1,"Y");c(h,true)}else{f.add(1,"Y");c(f)}};i.selectDate=function(k,l,m){k.preventDefault();if(m){i.selectedDateTo=moment(l.year+" "+l.month+" "+l.day,i.format)}else{i.selectedDateFrom=moment(l.year+" "+l.month+" "+l.day,i.format)}i.daterange="";if(i.selectedDateFrom!==null&&i.selectedDateTo!==null){i.daterange=i.selectedDateFrom.format(i.format)+" - "+i.selectedDateTo.format(i.format);d.$setViewValue(i.daterange)}if(i.selectedDateFrom!==null&&i.selectedDateTo!==null){i.close()}};i.markDate=function(m,n){var k,l;if(n){if(i.selectedDateFrom===null){return}i.daysTo.forEach(function(p,o){p.active=false});k=moment(m.year+" "+m.month+" "+m.day,i.format);l=null;i.daysTo.forEach(function(p,o){l=moment(p.year+" "+p.month+" "+p.day,i.format);if(l<=k&&l>=i.selectedDateFrom){p.active=true}});i.daysFrom.forEach(function(p,o){l=moment(p.year+" "+p.month+" "+p.day,i.format);p.active=false;if(l<=k&&l>=i.selectedDateFrom){p.active=true}})}else{if(i.selectedDateTo===null){return}i.daysFrom.forEach(function(p,o){p.active=false});k=moment(m.year+" "+m.month+" "+m.day,i.format);l=null;i.daysFrom.forEach(function(p,o){l=moment(p.year+" "+p.month+" "+p.day,i.format);if(l>=k&&l<=i.selectedDateTo){p.active=true}});i.daysTo.forEach(function(p,o){l=moment(p.year+" "+p.month+" "+p.day,i.format);p.active=false;if(l>=k&&l<=i.selectedDateTo){p.active=true}})}};var b=["ng-daterangepicker","ng-daterangepicker-container"];if(g.id!==undefined){b.push(g.id)}a.on("click",function(m){if(!i.opened){return}var l=0,k;if(!m.target){return}for(k=m.target;k;k=k.parentNode){var o=k.id;var n=k.className;if(o!==undefined){for(l=0;l<b.length;l+=1){if(o.indexOf(b[l])>-1||n.indexOf(b[l])>-1){return}}}}i.close();i.$apply()});d.$render=function(){var k=d.$viewValue;if(k!==undefined){i.daterange=k}}},template:'<div class="ng-daterangepicker-container">  <input class="date" type="text" ng-model="daterange" ng-focus="open()">  <div class="ng-daterangepicker" ng-show="opened">    <div class="ng-calendar-container">      <div class="controls">        <div class="left">          <i class="fa fa-backward prev-year-btn" ng-click="prevYear()"></i>          <i class="fa fa-angle-left prev-month-btn" ng-click="prevMonth()"></i>        </div>        <span class="date">{{ dateFromValue }}</span>        <div class="right">          <i class="fa fa-angle-right next-month-btn" ng-click="nextMonth()"></i>          <i class="fa fa-forward next-year-btn" ng-click="nextYear()"></i>        </div>      </div>      <div class="day-names">        <span ng-repeat="dn in dayNames track by $index">          <span>{{ dn }}</span>        </span>      </div>      <div class="cal">        <span ng-repeat="d in daysFrom track by $index">          <span class="day" ng-click="selectDate($event, d, false)" ng-class="{disabled: !d.enabled, active: d.active && d.enabled}" ng-mouseover="markDate(d, false)">{{ d.day }}</span>        </span>      </div>    </div>    <div class="ng-calendar-container">      <div class="controls">        <div class="left">          <i class="fa fa-backward prev-year-btn" ng-click="prevYear(true)"></i>          <i class="fa fa-angle-left prev-month-btn" ng-click="prevMonth(true)"></i>        </div>        <span class="date">{{ dateToValue }}</span>        <div class="right">          <i class="fa fa-angle-right next-month-btn" ng-click="nextMonth(true)"></i>          <i class="fa fa-forward next-year-btn" ng-click="nextYear(true)"></i>        </div>      </div>      <div class="day-names">        <span ng-repeat="dn in dayNames track by $index">          <span>{{ dn }}</span>        </span>      </div>      <div class="cal">        <span ng-repeat="d in daysTo track by $index">          <span class="day" ng-click="selectDate($event, d, true)" ng-class="{disabled: !d.enabled, active: d.active && d.enabled}" ng-mouseover="markDate(d, true)">{{ d.day }}</span>        </span>      </div>    </div>  </div></div>'}}]);